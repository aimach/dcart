import{u as b,P as M,j as e,B as m,a1 as I,W as k,r as d,a2 as F,s as w,a5 as q,H as E,J as L,l as O,L as A,ah as H,a3 as V}from"./index-BxFqVAtU.js";import{u as S}from"./index.esm-DU5Jd49H.js";import{L as r}from"./LabelComponent-Dc0vkv4j.js";import{E as R}from"./ErrorComponent-DHhBf5Ed.js";import{g as P}from"./putRequests-B23pqD-4.js";import{e as B,f as J}from"./deleteRequests-D1QlB_A_.js";import{C as U}from"./circle-plus-Cot57x0J.js";const W="_tagManagementSection_w7l7v_1",$="_tagManagementHeader_w7l7v_12",z="_tagManagementContainer_w7l7v_23",G="_tagManagementForm_w7l7v_45",K="_tagManagementRow_w7l7v_55",Q="_tagInputContainer_w7l7v_63",X="_buttonContainer_w7l7v_79",t={tagManagementSection:W,tagManagementHeader:$,tagManagementContainer:z,tagManagementForm:G,tagManagementRow:K,tagInputContainer:Q,buttonContainer:X},Y=({tag:n})=>{const{translation:a,language:s}=b(),{setReload:x,reload:u,openDeleteModal:g,setIdToDelete:j}=M(),{register:o,handleSubmit:l,formState:{errors:c}}=S({defaultValues:n??{}}),i=async p=>{await P(p)===200?(I("Etiquette",!0),x(!u)):k("Erreur lors de la mise à jour de l'étiquette")},f=p=>{g(),j(p)};return e.jsxs("form",{onSubmit:l(i),children:[e.jsxs("div",{className:t.tagManagementForm,children:[e.jsxs("div",{className:t.tagManagementRow,children:[e.jsxs("div",{className:t.tagInputContainer,children:[e.jsx(r,{htmlFor:"name_fr",label:"Nom en français :",description:""}),e.jsx("input",{type:"text",id:"name_fr",defaultValue:n.name_fr,...o("name_fr",{required:"Le champ du nom en français est requis"})})]}),e.jsxs("div",{className:t.tagInputContainer,children:[e.jsx(r,{htmlFor:"name_en",label:"Nom en anglais :",description:""}),e.jsx("input",{type:"text",id:"name_en",defaultValue:n.name_en,...o("name_en",{required:"Le champ du nom en anglais est requis"})})]})]}),e.jsxs("div",{className:t.tagManagementRow,children:[e.jsxs("div",{className:t.tagInputContainer,children:[e.jsx(r,{htmlFor:"description_fr",label:"Description en français :",description:""}),e.jsx("textarea",{id:"description_fr",defaultValue:n.description_fr,...o("description_fr")})]}),e.jsxs("div",{className:t.tagInputContainer,children:[e.jsx(r,{htmlFor:"description_en",label:"Description en anglais :",description:""}),e.jsx("textarea",{id:"description_en",defaultValue:n.description_en,...o("description_en")})]})]}),Object.keys(c).length>0&&e.jsx(R,{message:c[Object.keys(c)[0]].message})]},n.id),e.jsxs("div",{className:t.buttonContainer,children:[e.jsx(m,{type:"button",color:"brown",textContent:a[s].button.edit,onClickFunction:l(i)}),e.jsx(m,{type:"button",color:"red",textContent:a[s].button.delete,onClickFunction:()=>f(n.id)})]})]})},Z=()=>{const{language:n,translation:a}=b(),{reloadTags:s,setReloadTags:x}=d.useContext(F),{closeDeleteModal:u,idToDelete:g,reload:j,setReload:o}=M(),l=async c=>{await B(c)===200&&(u(),o(!j),q("Étiquette",!0),x(!s))};return e.jsxs("div",{className:w.modalCustomContentContainer,children:[a[n].modal.deleteTagText,e.jsxs("div",{className:w.buttonContainer,children:[e.jsx(m,{type:"button",onClickFunction:()=>l(g),color:"green",textContent:a[n].modal.yes}),e.jsx(m,{type:"button",onClickFunction:u,color:"red",textContent:a[n].modal.no})]})]})},re=()=>{const{isAdmin:n}=d.useContext(E),{translation:a,language:s}=b(),{reloadTags:x,setReloadTags:u}=d.useContext(F),g=L(),{closeDeleteModal:j,isDeleteModalOpen:o,reload:l,setReload:c}=M(),[i,f]=d.useState(!1);d.useEffect(()=>{n||g("/backoffice")},[n,g]);const[p,v]=d.useState([]);d.useEffect(()=>{(async()=>{const T=await H();v(T)})()},[l]);const{register:h,handleSubmit:y,formState:{errors:_},reset:D}=S(),N=async C=>{await J(C)===201&&(f(!1),V("Etiquette",!0),c(!l),u(!x),D())};return p.length>0?e.jsxs("section",{className:t.tagManagementSection,children:[o&&e.jsx(O,{onClose:()=>j(),children:e.jsx(Z,{})}),e.jsx("div",{className:t.tagManagementHeader,children:i?e.jsx(m,{type:"button",textContent:a[s].button.cancel,color:"brown",onClickFunction:()=>f(!i)}):e.jsx(m,{type:"button",textContent:a[s].button.add,color:"brown",onClickFunction:()=>f(!i),icon:e.jsx(U,{})})}),e.jsx("div",{className:t.tagManagementContainer,children:i?e.jsx("form",{onSubmit:y(N),children:e.jsxs("div",{className:t.tagManagementForm,children:[e.jsxs("div",{className:t.tagManagementRow,children:[e.jsxs("div",{className:t.tagInputContainer,children:[e.jsx(r,{htmlFor:"name_fr",label:"Nom en français",description:""}),e.jsx("input",{type:"text",id:"name_fr",...h("name_fr",{required:"Le champ du nom en français est requis"})})]}),e.jsxs("div",{className:t.tagInputContainer,children:[e.jsx(r,{htmlFor:"name_en",label:"Nom en anglais",description:""}),e.jsx("input",{type:"text",id:"name_en",...h("name_en",{required:"Le champ du nom en anglais est requis"})})]})]}),e.jsxs("div",{className:t.tagManagementRow,children:[e.jsxs("div",{className:t.tagInputContainer,children:[e.jsx(r,{htmlFor:"description_fr",label:"Description en français",description:""}),e.jsx("input",{type:"text",id:"description_fr",...h("description_fr")})]}),e.jsxs("div",{className:t.tagInputContainer,children:[e.jsx(r,{htmlFor:"description_en",label:"Description en anglais",description:""}),e.jsx("input",{type:"text",id:"description_en",...h("description_en")})]})]}),e.jsx(m,{type:"button",color:"brown",textContent:a[s].button.add,onClickFunction:y(N)}),Object.keys(_).length>0&&e.jsx(R,{message:_[Object.keys(_)[0]].message})]})}):p.map(C=>e.jsx(Y,{tag:C},C.id))})]}):e.jsx(A,{})};export{re as default};
