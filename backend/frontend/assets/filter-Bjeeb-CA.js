import{c as b,b as A,i as S}from"./index-BxFqVAtU.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],F=b("Filter",_),m=A(i=>({hasFilteredPoints:!1,setHasFilteredPoints:e=>i({hasFilteredPoints:e}),initialLocationOptions:[],initialElementOptions:[],initialElementNbOptions:null,initialAgentActivityOptions:[],initialAgentStatusOptions:[],initialAgentivityOptions:[],initialAgentGenderOptions:[],initialSourceMaterialOptions:[],initialSourceTypeOptions:[],initialSourceLanguageOptions:{greek:!1,semitic:!1},filteredLocationOptions:[],filteredElementOptions:[],filteredElementNbOptions:null,filteredAgentActivityOptions:[],filteredAgentStatusOptions:[],filteredAgentivityOptions:[],filteredAgentGenderOptions:[],filteredSourceMaterialOptions:[],filteredSourceTypeOptions:[],filteredSourceLanguageOptions:{greek:!1,semitic:!1},setInitialLocationOptions:e=>i({initialLocationOptions:e}),setInitialElementOptions:e=>i({initialElementOptions:e}),setInitialElementNbOptions:e=>i({initialElementNbOptions:e}),setInitialAgentActivityOptions:e=>i({initialAgentActivityOptions:e}),setInitialAgentStatusOptions:e=>i({initialAgentStatusOptions:e}),setInitialAgentivityOptions:e=>i({initialAgentivityOptions:e}),setInitialAgentGenderOptions:e=>i({initialAgentGenderOptions:e}),setInitialSourceMaterialOptions:e=>i({initialSourceMaterialOptions:e}),setInitialSourceTypeOptions:e=>i({initialSourceTypeOptions:e}),setInitialSourceLanguageOptions:e=>i({initialSourceLanguageOptions:e}),setFilteredLocationOptions:e=>i({filteredLocationOptions:e}),setFilteredElementOptions:e=>i({filteredElementOptions:e}),setFilteredElementNbOptions:e=>i({filteredElementNbOptions:e}),setFilteredAgentActivityOptions:e=>i({filteredAgentActivityOptions:e}),setFilteredAgentStatusOptions:e=>i({filteredAgentStatusOptions:e}),setFilteredAgentivityOptions:e=>i({filteredAgentivityOptions:e}),setFilteredAgentGenderOptions:e=>i({filteredAgentGenderOptions:e}),setFilteredSourceMaterialOptions:e=>i({filteredSourceMaterialOptions:e}),setFilteredSourceTypeOptions:e=>i({filteredSourceTypeOptions:e}),setFilteredSourceLanguageOptions:e=>i({filteredSourceLanguageOptions:e}),resetFilteredOptions:()=>i(e=>({filteredLocationOptions:e.initialLocationOptions,filteredElementOptions:e.initialElementOptions,filteredElementNbOptions:e.initialElementNbOptions,filteredAgentActivityOptions:e.initialAgentActivityOptions,filteredAgentStatusOptions:e.initialAgentStatusOptions,filteredAgentivityOptions:e.initialAgentivityOptions,filteredAgentGenderOptions:e.initialAgentGenderOptions,filteredSourceMaterialOptions:e.initialSourceMaterialOptions,filteredSourceTypeOptions:e.initialSourceTypeOptions,filteredSourceLanguageOptions:e.initialSourceLanguageOptions,hasFilteredPoints:!1})),resetInitialOptions:()=>i(()=>({initialLocationOptions:[],initialElementOptions:[],initialElementNbOptions:null,initialAgentActivityOptions:[],initialAgentStatusOptions:[],initialAgentivityOptions:[],initialAgentGenderOptions:[],initialSourceMaterialOptions:[],initialSourceTypeOptions:[],initialSourceLanguageOptions:{greek:!1,semitic:!1},filteredLocationOptions:[],filteredElementOptions:[],filteredElementNbOptions:null,filteredAgentActivityOptions:[],filteredAgentStatusOptions:[],filteredAgentivityOptions:[],filteredAgentGenderOptions:[],filteredSourceMaterialOptions:[],filteredSourceTypeOptions:[],filteredSourceLanguageOptions:{greek:!1,semitic:!1},hasFilteredPoints:!1}))})),P=i=>{let e=0;for(const t in i)i[t]&&(e+=1);return e>=2},$=i=>{const e=[];for(let t=i.post;t<=i.ante;t+=100)e.push({value:t,label:t.toString()});return e},E=(i,e,t=!1)=>t?i.map(s=>({value:s.id,label:`${s[`nom_${e}`]} (${s.etat_absolu})`})):i.map(s=>({value:s.id,label:s[`nom_${e}`]})),M=(i,e,t)=>{const s=i,r=e,p=[],o=t?100:200;for(let n=s;n<=r;n+=o)n%10||p.push(n.toString());return p},v=i=>{const e=[];return i.map(t=>{t.sources.map(s=>{s.attestations.map(r=>{r.elements.map(p=>{e.find(o=>o.element_id===p.element_id)||e.push(p)})})})}),e},k=(i,e)=>{const t=[];return i.map(s=>{t.find(r=>r[e]===s[e])||t.push({grande_region_id:s.grande_region_id,grande_region_fr:s.grande_region_fr,grande_region_en:s.grande_region_en,sous_region_id:s.sous_region_id,sous_region_fr:s.sous_region_fr,sous_region_en:s.sous_region_en,nom_ville:s.nom_ville})}),t},T=(i,e,t)=>{switch(i){case"location":return{label:e[t].backoffice.mapFormPage.locationFilter.label,description:e[t].backoffice.mapFormPage.locationFilter.description};case"language":return{label:e[t].backoffice.mapFormPage.languageFilter.label,description:e[t].backoffice.mapFormPage.languageFilter.description};case"element":return{label:e[t].backoffice.mapFormPage.epithetFilter.label,description:e[t].backoffice.mapFormPage.epithetFilter.description};case"divinityNb":return{label:e[t].backoffice.mapFormPage.divinityNbFilter.label,description:e[t].backoffice.mapFormPage.divinityNbFilter.description};case"sourceType":return{label:e[t].backoffice.mapFormPage.sourceTypeFilter.label,description:e[t].backoffice.mapFormPage.sourceTypeFilter.description};case"agentActivity":return{label:e[t].backoffice.mapFormPage.agentActivityFilter.label,description:e[t].backoffice.mapFormPage.agentActivityFilter.description};case"agentGender":return{label:e[t].backoffice.mapFormPage.agentGenderFilter.label,description:e[t].backoffice.mapFormPage.agentGenderFilter.description};case"agentStatus":return{label:e[t].backoffice.mapFormPage.agentStatusFilter.label,description:e[t].backoffice.mapFormPage.agentStatusFilter.description};case"agentivity":return{label:e[t].backoffice.mapFormPage.agentivityFilter.label,description:e[t].backoffice.mapFormPage.agentivityFilter.description};case"sourceMaterial":return{label:e[t].backoffice.mapFormPage.sourceMaterialFilter.label,description:e[t].backoffice.mapFormPage.sourceMaterialFilter.description};default:return{label:e[t].backoffice.mapFormPage.noFilter.label,description:""}}},L=i=>{const e={post:400,ante:-1e3};for(const t of i)for(const s of t.sources)s.ante_quem>e.ante&&(e.ante=Math.ceil(s.ante_quem/10)*10),s.post_quem<e.post&&(e.post=Math.floor(s.post_quem/10)*10);return e},G=(i,e)=>{if(!i)return[];let t=[];const s=i.split("|")[0];return Number.isNaN(Number.parseInt(s,10))?(t=i.split("|"),(e??[]).filter(r=>t.includes(r.value))):(t=i.split("|").map(r=>typeof r=="string"?Number.parseInt(r,10):r),(e??[]).filter(r=>t.includes(typeof r.value=="string"?Number.parseInt(r.value,10):r.value)))},D=(i,e,t,s,r,p,o)=>{if(i==="locationId"||i==="elementId"){const n=e.map(c=>c.value).join("|");t({...s,[i]:n});const a=e.map(c=>c.label);o(a)}i==="post"&&r(e),i==="ante"&&p(e)},I=(i,e,t,s,r)=>{const p=i.map(n=>n.label);r(p);const o=i.map(n=>n.value).join("|");t({...s,[e]:o})},N=i=>{let e=0;for(const t in i)i[t]&&(e+=1);return e===0},w=(i,e,t,s,r,p,o,n,a,c,l,f)=>{const u=[];return(i.post!==-1e3||i.ante!==400)&&(i.post!==void 0&&u.push(`${f.common.after} ${i.post}`),i.ante!==void 0&&u.push(`${f.common.before} ${i.ante}`)),c.greek&&c.semitic?u.push(f.mapPage.noGreekOrSemitic):c.greek?u.push(f.mapPage.noGreek):c.semitic&&u.push(f.mapPage.noSemitic),e.length&&u.push(`${f.common.in} ${e.join(", ")}`),t.length&&u.push(`${f.mapPage.withElements} : ${t.join(", ")}`),r.length&&u.push(`${f.common.typeOf} : ${r.join(", ")}`),p.length&&u.push(`${f.mapPage.withStatus} : ${p.join(", ")}`),o.length&&u.push(`${f.mapPage.withAgentivities} : ${o.join(", ")}`),a.length&&u.push(`${f.mapPage.withSourceMaterials} : ${a.join(", ")}`),n.length&&u.push(`${f.mapPage.withAgentActivities} : ${n.join(", ")}`),Object.values(l??{}).some(g=>g)&&u.push(`${f.mapPage.gender} : ${Object.entries(l).map(([g,O])=>O?`${f.common.no} ${f.mapPage.aside[g]}`:null).filter(Boolean).join(", ")}`),s&&u.push(`${f.mapPage.withElementsNb} : ${s.min} ${f.common.to} ${s.max}`),u},C=(i,e)=>{const t=m.getState();if(y(i,"divinityNb")){let r=20,p=0;for(const o of e)for(const n of o.sources)for(const a of n.attestations)if(a.elements.length>0){const c=Object.values(a.elements.reduce((l,f)=>(l[f.element_id]=f.element_id,l),{}));c.length<r&&(r=c.length),c.length>p&&(p=c.length)}t.hasFilteredPoints?t.setFilteredElementNbOptions({min:r,max:p}):t.setInitialElementNbOptions({min:r,max:p})}},V=async(i,e,t,s,r=!1)=>{const p=m.getState(),o=await S();let n=[];i?n=v(e):n=o;const c=n.map(l=>i?{value:l.element_id,label:`${l[`element_nom_${t}`]} (${l.etat_absolu})`,nom_fr:`${l.element_nom_fr} (${l.etat_absolu})`,nom_en:`${l.element_nom_en} (${l.etat_absolu})`}:{value:l.id,label:`${l[`nom_${t}`]} (${l.etat_absolu})`,nom_fr:`${l.nom_fr} (${l.etat_absolu})`,nom_en:`${l.nom_en} (${l.etat_absolu})`}).sort((l,f)=>l.label.localeCompare(f.label));if(r)return c;if(p.hasFilteredPoints){const f=p.initialElementOptions.map(u=>{const d=!c.some(g=>g.value===u.value&&g.label===u.label);return{...u,isDisabled:d}});p.setFilteredElementOptions(f)}else p.setInitialElementOptions(c)},W=(i,e)=>{const t=m.getState(),s=[],r=new Set;i.map(o=>{o.sources.map(n=>{const a=n.types[`type_source_${e}`],c=n.types[`category_source_${e}`];a.map((f,u)=>f&&c[u]?`${c[u]} > ${f}`:f).map((f,u)=>{r.has(f)||f&&(r.add(f),s.push({type_fr:n.types.type_source_fr[u],type_en:n.types.type_source_en[u],label:f}))})})});const p=s.map(o=>({value:o.type_fr,label:o.label,isDisabled:t.hasFilteredPoints})).sort((o,n)=>o.label.localeCompare(n.label));if(t.hasFilteredPoints){const n=t.initialSourceTypeOptions.map(a=>{const c=!p.some(l=>l.value===a.value&&l.label===a.label);return{...a,isDisabled:c}});t.setFilteredSourceTypeOptions(n)}else t.setInitialSourceTypeOptions(p)},q=(i,e)=>{const t=m.getState(),s=[],r=new Set;for(const o of i)for(const n of o.sources)for(const a of n.attestations)if(a.agents&&a.agents.length>0)for(const c of a.agents){if(!c.activite_id)continue;const l=c.activite_id.toString();r.has(l)||c.activite_fr&&c.activite_en&&(r.add(l),s.push({id:l,nom_fr:c.activite_fr,nom_en:c.activite_en}))}const p=s.map(o=>({value:o.id,label:o[`nom_${e}`]})).sort((o,n)=>o.label.localeCompare(n.label));if(t.hasFilteredPoints){const n=t.initialAgentActivityOptions.map(a=>{const c=!p.some(l=>l.value===a.value&&l.label===a.label);return{...a,isDisabled:c}});t.setFilteredAgentActivityOptions(n)}else t.setInitialAgentActivityOptions(p)},x=(i,e)=>{const t=m.getState(),s=[],r=new Set;for(const o of i)for(const n of o.sources)for(const a of n.attestations)if(a.agents&&a.agents.length>0)for(const c of a.agents){if(!c.statut_fr)continue;const l=c.statut_fr,f=c.statut_en;r.has(l)||(r.add(l),s.push({nom_fr:l,nom_en:f}))}const p=s.map(o=>({value:o.nom_fr,label:o[`nom_${e}`],isDisabled:m.getState().hasFilteredPoints})).sort((o,n)=>o.label.localeCompare(n.label));if(t.hasFilteredPoints){const n=t.initialAgentStatusOptions.map(a=>{const c=!p.some(l=>l.value===a.value&&l.label===a.label);return{...a,isDisabled:c}});t.setFilteredAgentStatusOptions(n)}else t.setInitialAgentStatusOptions(p)},B=(i,e)=>{const t=m.getState(),s=[],r=new Set;for(const o of i)for(const n of o.sources)for(const a of n.attestations)if(a.agents&&a.agents.length>0){for(const c of a.agents)if(c.agentivites)for(const l of c.agentivites){const f=l.nom_fr,u=l.nom_en;r.has(f)||(r.add(f),s.push({nom_fr:f,nom_en:u}))}}const p=s.map(o=>({value:o.nom_fr,label:o[`nom_${e}`],isDisabled:m.getState().hasFilteredPoints})).sort((o,n)=>o.label.localeCompare(n.label));if(t.hasFilteredPoints){const n=t.initialAgentivityOptions.map(a=>{const c=!p.some(l=>l.value===a.value&&l.label===a.label);return{...a,isDisabled:c}});t.setFilteredAgentivityOptions(n)}else t.setInitialAgentivityOptions(p)},K=(i,e)=>{const t=m.getState(),s=[],r=new Set;for(const o of i)for(const n of o.sources){if(!n.types.material_fr)continue;const a=n.types.material_fr,c=n.types.material_en;r.has(a)||(r.add(a),s.push({nom_fr:a,nom_en:c,label:`${n.types[`material_category_${e}`]} > ${n.types[`material_${e}`]}`}))}const p=s.map(o=>({value:o.nom_fr,label:o.label})).sort((o,n)=>o.label.localeCompare(n.label));if(t.hasFilteredPoints){const n=t.initialSourceMaterialOptions.map(a=>{const c=!p.some(l=>l.value===a.value&&l.label===a.label);return{...a,isDisabled:c}});t.setFilteredSourceMaterialOptions(n)}else t.setInitialSourceMaterialOptions(p)},H=i=>{const e=m.getState(),t=[],s=new Set;for(const p of i)for(const o of p.sources)for(const n of o.attestations)if(n.agents&&n.agents.length>0){for(const a of n.agents)if(a.genres)for(const c of a.genres){const l=c.nom_fr,f=c.nom_en;s.has(l)||(s.add(l),t.push({nom_fr:l,nom_en:f}))}}const r=t.map(p=>p.nom_en.toLowerCase());if(e.hasFilteredPoints){const o=e.initialAgentGenderOptions.filter(n=>r.some(a=>a===n));e.setFilteredAgentGenderOptions(o)}else e.setInitialAgentGenderOptions(r)},y=(i,e)=>{var t;return(t=i==null?void 0:i.filterMapContent)==null?void 0:t.find(s=>s.filter.type===e)},z=(i,e,t)=>{const s=i.some(p=>!p.isDisabled&&p.value===e.value);if(!t)return s;const r=i.some(p=>!p.isDisabled&&p.value===t.value);return s&&r};export{F,L as a,G as b,$ as c,w as d,y as e,E as f,M as g,D as h,z as i,W as j,k,q as l,x as m,B as n,I as o,K as p,H as q,V as r,C as s,P as t,m as u,T as v,N as w};
